# 1.4 计算机系统的层次结构

## 前言

1. 传统计算机系统采用分层方式构建，也即计算机系统是一个层次结构系统
2. 通过向上层用户提供一个抽象的简洁接口而将较低层次的实现细节隐藏起来
3. 计算机解决应用问题的过程就是不同抽象层进行转换的过程

## 1.4.1 计算机系统抽象层的转换

1. **软件层级**

   应用问题-------->>用户

   算法-------->>程序员

   编程语言-------->>程序员

   操作系统/虚拟机-------->>程序员

2. **软件和硬件之间的交汇层：*****指令集体系结构(ISA)****-------->>架构师***

3. **硬件层级**

   微体系结构-------->>架构师

   功能部件-------->>架构师

   电路-------->>电子工程师

   器件-------->>电子工程师

4. 上图是计算机系统抽象层次的转换示意图，描述了从<u>最终用户希望计算机完成的应用(问题)到电子工程师使用器件完成基本电路设计的整个转换过程</u>

5. 计算机硬件只能理解机器语言，而将一个自然语言描述的应用问题转换为机器语言程序，需要经过多个抽象层的转换

—————————————————————————————————————————————————————————————————————————————————————

### 具体实现细节

1. **算法分析：**将应用问题转化为算法(algorithm)描述，使得应用问题的求解变成流程化的清晰步骤，并能确保是有限的；任何一个问题可能有多个求解算法，需要进行算法分析以确定哪种算法再时间和空间上能够得到优化

2. **编程语言实现细节**：将算法转换为编程语言描述的程序(program)，这个过程需要程序员进行程序设计；编程语言(programming language)与自然语言不同；它有着严格的执行顺序，不存在二义性(歧义)，**能过唯一地确定计算机执行指令地顺序**

3. **编程语言：**从抽象层次上来分：**可以分成高级语言和低级语言**

   <u>高级语言：</u>(high_level_language)和底层计算机结构关联不大，是机器无关语言，大部分的编程与语言都是高级语言；

   <u>低级语言：</u>(low_level_language)则和运行程序的计算机的底层结构密切相关，通常称为机器级语言(machine_level language)，机器语言和汇编语言都是机器级语言

   ​	<u>机器语言：</u>(machine_language)就是用二进制进行编码的机器指令(instruction)，每条机器指		令都是一个0/1序列

   ​	<u>汇编语言：</u>因为机器语言可读性很差，也不易记忆，因此人们引用了一种机器语言的符号表示语		言，通过简短的英文符号和二进制代码建立对应关系，以方便程序员编写和阅读机器语言程		序，这	种语言被称为**汇编语言(assembly language)**;

4. **翻译过程：**将高级语言程序转换成计算机能够理解的机器语言程序；我们把进行这种转换的软件称为**程序设计语言处理系统**；通常，程序员借助程序设计语言处理系统来开发程序，任何一个语言处理系统中，都包含一个**翻译程序(translator)**,它能把一种编程语言表示的程序转换为等价的另一种编程语言程序；被翻译的语言和程序分别称为**源语言**和**源程序**，**翻译生成的语言和程序分别称为目标语言和目标程序**

   - <u>翻译程序有以下三类</u>：
     1. **汇编程序(assembler)**：也称**汇编器**，<u>用来将汇编语言源程序翻译成机器语言目标程序</u>
     2. **解释程序(interpreter)：**也称**解释器**，<u>用来将源程序中的语句按其执行顺序逐条翻译成机器指令并立即执行</u>
     3. **编译程序(compiler)：**，也称编译器，<u>用来将高级语言源程序翻译成汇编语言成机器语言目标程序</u>

5. **操作系统**：操作系统是对计算机底层结构和计算机硬件的一种抽象，这种抽象构成了一台可以让程序员使用的虚拟机(virtual machine)

6. **指令集体系结构(Instruction Set Architecture,ISA)**,简称体系结构或系统结构(architecture)：它是机器语言程序和所运行的计算机硬件和软件之间的一个“桥梁”

7. **ISA：**定义了一台计算机可以执行的所有指令的集合，每条指令规定了计算机执行什么操作，以及所处理的操作数存放的地址空间和操作数类型，程序可访问的寄存器个数，位数，编号，控制寄存器的定义，I/O空间的编址方式，中断结构，机器工作状态的定义和切换，输入/输出结构和数据传送方式，存储保护方式等；因此可以看出，指令集体系结构是指软件能感知到的部分，也称为软件可见部分

8. **微体系结构(microarchitecture)**，简称为微架构；计算机硬件执行机器语言的过程就是让其执行一条一条指令的过程；ISA是对指令系统的一种规定或结构规范，具体实现的组织称为微体系结构；

9. **ISA与微体系结构的区别：**ISA与微体系结构是两个不同层面的概念，微体系结构是软件不可感知的部分；例如：加法器采用串行进位方式还是并行进位方式实现于微体系结构；相同的ISA可能具有不同的微体系结构；例如，对于Intel x86这种ISA，很多处理器的组织方式很多，也即具有不同的微体系结构，但因为它们具有相同的ISA，所以一种处理器上运行的程序，再另一种处理器上也能运行

10. 微体系结构最终是由**逻辑电路(logic circuit)**实现的，当然，微架构中的一个功能部件可以用不同的逻辑来实现，用不同的逻辑实现方式得到的性能和成本是有差异的

11. 每个基本的逻辑电路都是按照特定的器件技术(device technology)实现的，例如：CMOS电路中使用的器件和NMOS电路中使用的器件不同

## 1.4.2 计算机系统的不同用户

- 按照计算机上完成的任务不同，可以把使用计算机的用户分成以下4类：**最终用户，系统管理员，应用程序员和系统程序员**

1. 使用应用程序完成特定任务的计算机用户称为**最终用户(end user)**，比如：使用炒股软件的股民，玩计算机游戏的人等
2. **系统管理员(system administrator)**是指利用操作系统等软件提供的功能对系统进行配置，管理和维护，以建立高效合理的系统环境提供计算机用户使用的操作人员；其职责主要包括：安装，配置，和维护系统的硬件和软件，建立和管理用户账户，升级软件，备份和回复业务系统和数据等
3. **应用程序员(application programmer)**是指使用高级编程语言编制应用软件的程序员
4. **系统程序员(system programmer)**则是指设计和开发系统软件的程序员，如开发操作系统，编译器，数据库管理系统等系统软件的程序员
5. 计算机系统采用层次化体系结构，不同用户工作时在不同的系统结构层，所看到的计算机的概念性机构和功能特性是不同的

—————————————————————————————————————————————————————————————————————————————————————

### 应用程序员

1.  应用程序员大多使用高级程序设计语言编程程序；是指面向算法设计的较接近日常所用的英语书面语言的程序设计语言，如：BASIC，C/C++,Java
2. 应用程序员所看到的计算机系统除了计算机硬件，<u>**操作系统提供的应用编程接口(API)**，人机交互界面和实用程序外，还包括相应的程序语言处理系统</u>
3. 在语言处理系统中，除了<u>翻译程序外，通常还包括编辑程序，链接程序，装入程序</u>以及将这些程序和工具集成在一起所构成的**集成开发环境(Integrated Development Environment，简称IDE)**

### 系统程序员

1. 系统程序员开发操作系统，编译器和使用程序等系统软件时，需要熟悉计算机底层的相关硬件和系统结构，甚至可能需要直接与计算机硬件和指令打交道；比如，**直接对各种控制寄存器，用户可见寄存器，I/O控制器等硬件进行控制和编程**；因此，系统程序员必须熟悉指令系统，机器结构和相关的机器功能特性，有时还要直接用汇编语言等低级语言编写程序代码

2. 对实际存在的事物或概念感觉不到，则称为**透明**；通常在一个计算机系统中，系统程序员所看到的底层机器级的概念性结构和功能特性对高级语言程序员(通常来说是程序员)来说是透明的，也即看不见或感觉不到的；

   ### 计算机系统层次化结构

   1. ISA处于硬件和软件的交界面上，硬件的所有功能都由ISA集中体现，软件通过ISA在计算机上执行，所以，ISA是整个计算机系统中的核心部分
   2. ISA层下面是硬件部分，上面是软件部分
   3. 硬件部分包括CPU，主存和输入/输出等主要功能部件，这些功能部件通过数字逻辑电路设计实现
   4. 软件部分包括底层的系统软件和高层的图办公厅软件，汇编程序，编译程序和操作系统等系统软件直接在ISA上实现
   5. 系统程序员所看到的机器的属性是属于ISA层面的内容，所看到的机器是配置了指令系统的机器，称为**机器语言机器**，工作在该层次的程序员称为机器语言程序员
   6. 系统管理员工作在操作系统层，所看到的是配置了操作系统的虚拟机器，称为**操作系统虚拟机**
   7. 汇编语言程序员工作在提供汇编程序的虚拟机器级，所看的语言称为**汇编语言虚拟机**
   8. 应用程序员大多工作在提供编译器或解释器等翻译程序的语言处理系统层，因此应用程序员大多用高级语言编写程序，因而也称为高级语言程序员，所看到的虚拟称为**高级语言虚拟机**
   9. 最终用户则工作在最上面的**应用程序层**